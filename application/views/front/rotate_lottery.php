<!doctype html><html><head><meta charset="utf-8"><title>转盘</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href="<?php echo base_url()?>assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><style>	*{padding:0;margin:0}	body{		text-align:center	}	.ly-plate{		position:relative;		margin: 50px auto;	}	.ly-plate img{		margin: 0 auto;	}	.rotate-bg{		position:relative;		top:0;		left:0;		z-index: 1;	}	.ly-plate .lottery-star{		width:200px;		height:200px;		position:absolute;		top:0;		left:0;		outline:none;		z-index: 2;	}</style></head><body><div class="container">	<div class="row">		<div class="col-xs-12">			<div class="row ly-plate">				<div class="rotate-bg col-xs-12"><img class="img-responsive" src="<?=site_url('img/ly-plate.png')?>"></div>				<div class="lottery-star col-xs-12"><img class="img-responsive" src="<?=site_url('img/rotate-static.png')?>" id="lotteryBtn"></div>			</div>		</div>	</div></div><script src="<?=base_url()?>assets/plugins/jquery-1.10.2.min.js" type="text/javascript"></script><script src="<?=base_url()?>assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script><script src="<?=base_url()?>lib/rotate/jQueryRotate.2.2.js"></script><script type="text/javascript">var lotteryData = [];<?php foreach ($result as $key => $value) {	echo "lotteryData.push(".$value.");";}?>$(function(){	var timeOut = function(){  //超时函数		$("#lotteryBtn").rotate({			angle:0, 			duration: 10000, 			animateTo: 2160, //这里是设置请求超时后返回的角度，所以应该还是回到最原始的位置，2160是因为我要让它转6圈，就是360*6得来的			callback:function(){				alert('网络超时')			}		}); 	}; 	var rotateFunc = function(angle,text){  //angle:奖项对应的角度		$('#lotteryBtn').stopRotate();		$("#lotteryBtn").rotate({			angle:0, 			duration: 5000, 			animateTo: angle+1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^			callback:function(){				alert(text)			}		}); 	};		$("#lotteryBtn").rotate({ 		bind: {			click: function(){				$.ajax({					type: "POST",					dataType: "json",					url: "draw",					success: function(response){						var prize = $.inArray(parseInt(response.id), lotteryData);						switch(prize){							case 0:								rotateFunc(157,'恭喜您抽中的一等奖:'+ response.name);								break;							case 1:								rotateFunc(247,'恭喜您抽中的二等奖:'+ response.name);								break;							case 2:								rotateFunc(22,'恭喜您抽中的三等奖:'+ response.name);								break;							default:								var angle = [67,112,202,292,337];								rotateAngle = angle[Math.floor(Math.random()*angle.length)];								rotateFunc(rotateAngle, response.name);								break;						}					}				});			}		} 	   	});		var bgWidth = $('.rotate-bg').width();	var bgHeight = $('.rotate-bg').height();		var starWidth = $('.lottery-star').width();	var starHeight = $('.lottery-star').height();	$('.lottery-star').css('left', (bgWidth-starWidth)/2);	$('.lottery-star').css('top', (bgHeight-starHeight)/2+15);})</script></body></html>